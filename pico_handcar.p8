pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
#include cart.p8
#include settings.p8
#include ui.p8
#include upgrades.p8
#include utils.p8
#include world.p8

function _init()
	init_settings()
	init_cart()
	init_topo()
	init_rocks()
	init_fx()
	init_upgrades()
end

function _update60()
	pump_minigame()
	cart_physics()
	update_topo()
	update_rocks()
	update_fx() 
end

function _draw()
	cls(12)
	draw_topo()
	draw_cart()
	draw_rocks()
	draw_fx()
	draw_ui()
end

--[[
Special thanks:

Particle FX base function
https://nerdyteachers.com/PICO-8/Game_Mechanics/?tutorial=14

Tomorrow Night font by VEXED
https://v3x3d.itch.io/tomorrow-night
]]

__gfx__
0004444400000009444900000000555000000000555000000000666000000000777000000000000000055550000000008880000000000000000f000000000000
0044040440000044040440000054040540000055050550000066666660000076ddd670000005d550055dddda000000008888000000000000f00f000000000000
0440040044000404040404000450050055000560050065000666ddd66600076ddddd67000055daa50ddddaaa00dd05508888000000000000f0f000f000000000
440404040460944444444490050505050500050505050500066d666d660006ddddddd600055dddda5ddddddd0ddda5550888800000000000ff0000f000000000
40004440004040044644004050005450005050005650005066d66766d6607ddddadddd705adaaddd5aaadddddddd5d5508888000000000000ff0ff00000b00b0
44444644444044446664444055545445455055556665555066d67776d6607ddda7addd70addddddd5addddd5adad55a5008888000000000000ff00000b0b0b00
40004440004040044644004050005550005050005650005066d66766d6607ddddadddd70ddddaaadaadddd555dd555550088880000000000000ff0000bbbbb00
440404040440944444444490040505050400050505050500066d666d660006ddddddd600dddaddddadddda550dd5a5a50008888000000000000f000000b0b000
0440040044000404040404000540050055000560050065000666ddd66600076ddddd670000000000000000000000000000000000000000000000000000000000
0044040440000044040440000055040550000055050550000066666660000076ddd6700000000000000000000000000000888880000000000009009000000000
0004444400000009444900000000554000000000555000000000666000000000777000000000000000000000000000002288888800000000090b090000000000
000000000000000000000000000000000000000000000000000000000000044000000000000044000000000000000000078788880000000000b00b0000065550
000000000000000000000000000000000000000000000000000000000000044400000000000044400000000000000000027888880000000000b0b0000665565d
0000000000000000000000000000000000000000000000000000000000000444040000000000444040000000004400000787888800000000000bb0006555555d
00000000000000000000000070000000000000000000000000000000000044444000000000044444000000000044400002888888000000000000b000655555dd
0000000000000000000000007000000000000000000000000000000000040fff000000000040fff0000000000044404000888800000000000000b0005555dddd
0000000000000000000000002000000000000000000000000000000000000fff000000000000fff0000000000444440000000000000000000000000000000000
00000000000000000000000020000000000000000000000000000044fcc00ff1000000000000ff100000000040fff00000025000000000000006556000000000
00000000000000000000000222000000000000000000000000000044fccc811100000000000811100000000000fff00000025500000000000065555500f00000
0000000000000000000000022200000000000000000000000000070000ccccc1000000000081cc100000000000fff10005525550000000000655555600ff0f00
000000000000000000000022722000000000000000000000000070000000ccc10000044fcccccc100000000000811100055255550000000006555655000f0ff0
00000000000000000000002070200000000000000000000000070000000011110077744fccccc1100700000000cc110005525550000000000556555d00ffff00
00000000000000000000022070220000000000000000000000000000000111110000000000111110007000000ccc11000002550000000000055555dd0000f000
0000000000000000000002007002000000000000000000000000000000011111000000000011111000070000ccc11100000250000000000000556dd00000f000
78888888888888888888228878822888888888888888888870000000000444440000000000444440000044fccc111100000000000000000000b3300000000000
722222222222222222222222222222222222222222222228700000000000cccc00000000000cccc0000044fcc44444000000000000000000000b3b0000bbb000
788222822282228222822282228222822282228222822228700000000000cccc00000000000cccc0000000000ccccc000000000000000000000330000b838bb0
78888888888888888888888888888888888888888888822870000000000ccc110000000000ccc11000000000cccccc00055560000000000000b33b00be333e3b
78888800022222220000000000000000022222220888888870000000000cc0110000000000cc011000000000ccc0110002556666000000000003b000b333833b
88888000000222000000000000000000000222000008888880000000000cc0110000000000cc0110000000000cc01100055560000000000000033b00b3e333e0
000000000002220000000000000000000002220000008888800000000044455500000000044455500000000044455500000000000000000000b330000b3338b0
000000000000200000000000000000000000200000000000000000000044455500000000044455500000000044455500000000000000000000033b0000b83b00
00000999990000000000099999000000000009999900000000000999990000000000000000000000000000000000000000000000000000000000000000000000
00099004009900000009900000990000000990000099000000099000009900000000000000000000000000000000000000000000000000000000000000000000
00900004000090000090000004009000009000000000900000900400000090000000000000000000000000000000000000000000000000000000000000000000
04000004000009000400000004000900040400000004090004000400000009000000000000000000000000000000000000000000000000000000000000000000
04000004000009000400000040000900040040000040090004000040000009000000000000000000000000000000000000000000000000000000000000000000
40000004000000904044000040000090400004000400009040000040000440900000000000000000000000000000000000000000000000000000000000000000
40000047400000904000444740000090400000474000009040000047444000900000000000000000000000000000000000000000000000000000000000000000
44444466644444404000006660000040400000666000004040000066600000400000000000000000000000000000000000000000000000000000000000000000
4000004d400000404000004d444000404000004d400000404000444d400000400000000000000000000000000000000000000000000000000000000000000000
40000004000000404000004000044040400004000400004040440000400000400000000000000000000000000000000000000000000000000000000000000000
04000004000004000400004000000400040040000040040004000000400004000000000000000000000000000000000000000000000000000000000000000000
04000004000004000400040000000400040400000004040004000000040004000000000000000000000000000000000000000000000000000000000000000000
00400004000040000040040000004000004000000000400000400000040040000000000000000000000000000000000000000000000000000000000000000000
00044004004400000004400000440000000440000044000000044000004400000000000000000000000000000000000000000000000000000000000000000000
00000444440000000000044444000000000004444400000000000444440000000000000000000000000000000000000000000000000000000000000000000000
__map__
4041000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
5051000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
